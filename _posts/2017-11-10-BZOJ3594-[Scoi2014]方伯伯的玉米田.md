---
layout: post
title: BZOJ3594 [Scoi2014]方伯伯的玉米田
date: 2017-01-01 00:00
img: https://vexoben.github.io/assets/images/Blog/博客搬家.jpg
---

题目链接：[https://www.lydsy.com/JudgeOnline/problem.php?id=3594][1]

## 题解

题目链接：https://www.lydsy.com/JudgeOnline/problem.php?id=1925

先考虑ＤＰ：**f[i][j][k]**表示第ｉ株玉米，用了ｊ次拔高，第ｉ株玉米高度为ｋ的连续玉米数是多少，转移O(n)，复杂度O(n^3*k)

注意到很明显的一个贪心：如果我们要拔高一列玉米，其右端点必然是最后一株玉米，因为如果不在最后一株玉米，我们将它移至最后一株玉米，将两株相连的费用不会增加。

换言之，拔高玉米只会对左端点的相对顺序产生影响。 

所以压去ｋ这一维，考虑f[i][j]表示前ｉ株玉米，拔高ｊ次连续玉米数是多少，显然第ｉ株玉米一定被拔高了ｊ次，则有：  

$$ f[i][j]=max\{f[k][j]\}+1,(k<i,a[k]<=a[i]) $$$$ f[i][j]=max\{f[k][j-a[k]+a[i]]\}+1,(k<i,a[k]>a[i]) $$

复杂度$O(n^2*k)$，并不会优化…